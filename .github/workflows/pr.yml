name: Events Demo 1
on:
  push:
    branches:
      - develop
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Output event data
        run: echo "${{ toJSON(github.event) }}"
      - name: Get code
        uses: actions/checkout@v3
  test:
      runs-on: ubuntu-latest
      needs: deploy
      steps:
      - uses: actions/checkout@v4
      - uses: ruby/setup-ruby@v1
        with:
          ruby-version: '3.3' # Not needed with a .ruby-version file
          bundler-cache: true # runs 'bundle install' and caches installed gems automatically
      - run: bundle exec rake
      - name: Deploy project
        run: echo "Deploying to test environment..."
  create_pull_request:
    needs: test
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3  
    - name: Create Auto PR
      uses: rematocorp/open-pull-request-action@v1
      with:
        # Github token, https://docs.github.com/en/actions/reference/authentication-in-a-workflow
        github-token: ${{ secrets.GITHUB_TOKEN }}
        # head branch
        from-branch: develop
        # base branch
        to-branch: staging
        # 
        repository-owner: sreenak
        # 
        repository: DevopsTest
          
